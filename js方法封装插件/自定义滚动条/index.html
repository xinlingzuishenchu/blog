<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link rel="stylesheet" href="css/reset.css">
	<style>
	#wrap{
		width: 300px;
		height: 400px;
		border: 1px solid #ccc;
		position: absolute;
		left: 100px;
		top: 100px;
		font-size: 40px;
		overflow: hidden;
	}
	#text{
		position: absolute;
	}
	#right{
		position: absolute;
		right: 0;
		top: 0;
		width: 20px;
		height: 100%;
		background: #999;
	}
	#slider{
		position: absolute;
		width: 20px;
		height: 50px;
		background: red;
		border-radius: 10px;
		cursor:default; /*光标是箭头*/
	}
	</style>
</head>
<body>
	<div id="wrap">
		<div id="text">
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   
			偶俄日哦迫我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
			肯德基和分解为hi护卫级诶我奇偶IE噢诶无欧日饿哦我 我偶尔去玩我噢诶抛弃我IPOIEIQ嗯我防控恩平认为开发饿哦人品   偶俄日哦迫
		</div>
		<div id="right">
			<div id="slider"></div>
		</div>
	</div>
</body>
</html>
<script>
	//获取滚动条
	var slider = document.querySelector('#slider');
	var wrap = document.querySelector('#wrap');
	var text = document.querySelector('#text');
	var right = document.querySelector('#right');
	//首先得到一个比例：wrap的高度除以text的高度
	var scale = wrap.offsetHeight/text.offsetHeight;
	//给slider赋height值
	var h = right.offsetHeight * scale;
		if(h>=wrap.offsetHeight){
			right.style.display = 'none';
		}else if(h<50){
			h=50;
		}
		slider.style.height = h + 'px';
		//定义一个变量存放slider的top值
		var sliderTop = 0;
		//滚动条最大移动区域
		var max = right.offsetHeight - h;

	document.onkeydown = function(ev){
		var e = ev || window.event;
		
		switch(e.keyCode){
			case 38 :
				 sliderTop = sliderTop - 10;
				 moveFn()
			break;
			case 40 :
				sliderTop = sliderTop + 10;
				moveFn()
			break;
		}
		


	}

		//移动的函数
		function moveFn(){
			// sliderTop = sliderTop - 10;
				if(sliderTop<=0){
					sliderTop = 0;

				}else if(sliderTop>=max){
					sliderTop = max;
				}
				slider.style.top = sliderTop + 'px';
				//滚动的比例
				var sliderScale = sliderTop/max;

				//text.style.top 的值由sliderScale 这个比例决定
				text.style.top = -(text.offsetHeight - wrap.offsetHeight) * sliderScale + 'px';
		}

		//slider滚轮事件
		//向下滚动时，sliderTop + 10
		//向上滚动时，sliderTop - 10
		wrap.onmousewheel = function(ev){
			var e = ev || window.event;
			console.log(e.wheelDelta)
			if(e.wheelDelta>0){
				//slider向上滚动
				sliderTop = sliderTop - 10;
				moveFn()
				
			}else{
				//slider向下滚动
				sliderTop = sliderTop + 10;
				moveFn()
			}
		}
		//点击事件
		right.onmousedown = function(ev){
			var e = ev || window.event;
			console.log(e.clientX,e.clientY)
			sliderTop = e.clientY - wrap.offsetTop - h/2;
			moveFn();
			
		}
		//拖拽事件
		slider.onmousedown = function(ev){
			var e = ev || window.event;
			//阻止right.onmousedown事件传递
			e.stopPropagation();
			//用来记录点击slider时的位置
			//鼠标到slider上面的距离
			var disY = e.clientY - slider.offsetTop;
			document.onmousemove = function(ev){
				var e = ev || window.event;
				sliderTop = e.clientY - disY;
				moveFn();
			}
			//鼠标抬起，删除onmousemover 事件
			document.onmouseup = function(){
				document.onmousemove = null;
			}
		}
		document.onmousedown = function(){
			return false;
		}

</script>